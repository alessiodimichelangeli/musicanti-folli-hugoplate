{{ define "main" }}
{{/* Prendiamo l'immagine di sfondo dalla cartella /assets */}}
{{ $bg_image := resources.Get "images/background.jpg" }}

<main class="main">
  <section id="hero" class="section" style="background-image: linear-gradient(rgba(86, 7, 37, 0.7), rgba(86, 7, 37, 0.7)), url('{{ $bg_image.RelPermalink }}');">
    <div class="container">
      {{/* Controlliamo se esistono i dati del banner nel file _index.md */}}
      {{ with .Params.banner }}

        {{/* 1. Mostriamo il logo in alto */}}
        <div class="logo-container">
          {{/* Prendiamo il percorso del logo dal Front Matter e lo processiamo */}}
          {{ with .logo }}
            {{ $logo_img := resources.Get . }}
            {{ if $logo_img }}
              <img src="{{ $logo_img.RelPermalink }}" alt="Logo Musicanti Folli">
            {{ end }}
          {{ end }}
        </div>

        {{/* 2. Sotto il logo, mettiamo il titolo vuoto per l'animazione */}}
        <h1 id="typewriter" class="h1 mb-4" data-strings='{{ .animated_texts | jsonify }}'></h1>

        <!-- {{/* 3. E poi il resto del contenuto */}}
        <p class="mb-8">{{ .content | markdownify }}</p>

        {{/* Se il bottone Ã¨ abilitato, lo mostriamo */}}
        {{ if .button.enable }}
          <a class="btn btn-primary" href="{{ .button.link }}">
            {{ .button.label }}
          </a>
        {{ end }} -->

        <div class="scroll-down-container">
          <a href="/#chi-siamo" class="scroll-down-arrow" aria-label="Scorri verso il basso">
            {{/* Inseriamo l'icona SVG direttamente qui */}}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="36px" height="36px">
              <path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path>
            </svg>
          </a>
        </div>

      {{ end }}
    </div>
  </section>

  {{/* Codice per mostrare le altre sezioni della one-page */}}
  {{ $pages := where .Site.RegularPages "Section" "sezioni" }}
  {{ range $pages.ByWeight }}
    <section id="{{ .File.TranslationBaseName }}" class="section">
      <div class="container">
        <h2 class="h2 text-center mb-8">{{ .Title }}</h2>
        <div class="content">
          {{ .Content }}
        </div>
      </div>
    </section>
  {{ end }}

</main>

{{/* SCRIPT PER L'ANIMAZIONE */}}
{{/* 1. Carichiamo la nuova libreria TypewriterJS */}}
<script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>

{{/* 2. Avviamo la nuova animazione */}}
<script>
  document.addEventListener('DOMContentLoaded', function(){
    const typeElement = document.getElementById('typewriter');
    if (typeElement) {
      const stringsData = typeElement.getAttribute('data-strings');
      const stringsToType = JSON.parse(stringsData || '[]');

      // Inizializzazione di TypewriterJS
      new Typewriter(typeElement, {
        strings: stringsToType,
        autoStart: true,
        loop: true,
        delay: 50, // Corrisponde a typeSpeed
        cursor: '|',
      });
    }
  });
</script>

{{ end }}